# Caddyfile for WhatPad deployment with custom domain

# Frontend - Main Domain
whatpad.me {
    # Reverse proxy to frontend container
    reverse_proxy localhost:9080
    
    # Enable compression
    encode gzip
    
    # Logging
    log {
        output file /var/log/caddy/access.log
    }
}

# Backend API - Subdomain  
api.whatpad.me {
    # Reverse proxy to backend container
    reverse_proxy localhost:9081
    
    # Enable CORS
    header {
        Access-Control-Allow-Origin https://whatpad.me http://whatpad.me
        Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS"
        Access-Control-Allow-Headers "Authorization, Content-Type"
        Access-Control-Allow-Credentials true
    }
    
    # Enable compression
    encode gzip
    
    # Logging
    log {
        output file /var/log/caddy/api-access.log
    }
}